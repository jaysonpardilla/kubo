
{% load static %}
<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>E-Kubo: Add new category</title>
      <link rel="icon" type="image/png" href="{% static 'icons/ekubo_icon.png' %}">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
      <link rel="stylesheet" href="{% static 'css/slideup.css' %}">
      <style>
         body { background: #f7f7f8; font-family: Arial, sans-serif; }
         .center-card { max-width: 480px; margin: 36px auto; }
         .img-preview { max-width: 120px; max-height: 120px; object-fit: cover; }
      </style>
   </head>
   <body>
      <div class="container center-card slide-up">
         <div class="card shadow-sm p-4">
            <h5 class="text-center fw-bold mb-3">Add New Category</h5>
            <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
               {% csrf_token %}
               <div class="mb-3">
                  <label for="id_name" class="form-label">Category Name</label>
                  <input type="text" name="name" id="id_name" class="form-control" placeholder="Enter category name" required>
                  <div class="invalid-feedback">Please provide a category name.</div>
               </div>

               <div class="mb-3">
                  <label for="id_image" class="form-label">Category Image</label>
                  <input type="file" name="image" id="id_image" class="form-control" accept="image/*" required>
                  <div class="invalid-feedback">Please upload an image.</div>
                  <div class="text-center mt-3">
                     <img id="imagePreview" src="" alt="Image Preview" class="rounded border d-none img-preview">
                  </div>
               </div>

               <div class="d-flex justify-content-between">
                  <a href="{% url 'manage_business:home' %}" class="btn btn-outline-secondary btn-sm">Cancel</a>
                  <button type="submit" class="btn btn-primary btn-sm">Add Category</button>
               </div>
            </form>
         </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      <script src="{% static 'js/slideup.js' %}"></script>
      <script>
         (function(){
            // Image preview
            const input = document.getElementById('id_image');
            const preview = document.getElementById('imagePreview');
            if(input){
               input.addEventListener('change', function(){
                  const file = this.files && this.files[0];
                  if(!file){ preview.classList.add('d-none'); preview.src = ''; return; }
                  const reader = new FileReader();
                  reader.onload = function(e){ preview.src = e.target.result; preview.classList.remove('d-none'); };
                  reader.readAsDataURL(file);
               });
            }

            // Bootstrap form validation
            'use strict';
            var forms = document.querySelectorAll('.needs-validation');
            Array.prototype.slice.call(forms).forEach(function (form) {
                  form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) { event.preventDefault(); event.stopPropagation(); }
                        form.classList.add('was-validated');
                  }, false);
            });
         })();
      </script>
   </body>
</html>
